# RDD (Resilient Distributed DataSet)
* Spark 저수준 API 중 하나
  * 분산 데이터 처리를 위한 RDD
  * 브로드캐스트 변수와 분산형 공유 변수 배포하고 다루기 위한 API
  * 아래와 같은 상황에서 사용
    * 고수준 API에서 사용하지 않는 기능이 필요한 경우
    * 레거시 시스템을 유지/보수하는 경우
    * 사용자 정의 공유변수를 다루는 경우
  * ```SparkContext```를 통해 사용
      ```
      spark.sparkContext
      ```
* 파티셔닝된 레코드의 모음
  * 파티션의 목록
  * 각 조각을 연산하는 함수
  * 다른 RDD 의존성 목록
  * 키-값 RDD를 위한 Partitioner
  * 각 조각을 연산하기 위한 기본 위치 목록 
* 자바, 스칼라, 파이썬의 객체이기 때문에 완벽하게 제어 가능
  * 개발자가 완벽하게 제어해야 하는 만큼 많은 수작업이 필요
  * 로우 개념 없음
  * 자바, 스칼라의 경우 원형 객체 다룰 때 외 성능 비슷
  * 파이썬의 경우 성능 저하 상당함
* ```Dataset```과 유사하나 구조화 데이터 엔진을 사용하지 않음
  *  단, 상호 전환이 쉬움
* 제네릭 RDD와 키-값 RDD가 있음
* 트랜스포메이션 (지연 처리)와 액션(즉시 실행) 제공

## RDD 생성하기
* 데이터프레임으로 생성
  * 파이썬은 사용 불가
* 데이터셋으로 생성
  * 데이터 처리를 위해서 ```Row```객체 데이터 타입으로 변환하거나 값을 추출해야 함
    * ```Row``` 타입 구조적 API에서 데이터 표현 시 사용하는 카탈리스트 포맷
  ```
  # Dataset to RDD
  spark.range(10).rdd
 
  # RDD to Dataset
  spark.range(10).rdd.toDF()
  ```
* 로컬 컬렉션으로 RDD 생성하기
  * ```sparkContext```의 ```parallelize``` 메서드 사용
* 데이터소스로 RDD 생성하기
  * ```sparkContext``` 사용

## 트랜스포메이션
* ```distinct```
* ```filter```
* ```map```
* ```flatMap```
  * ```map```의 확장으로 여러 로우로 변환해줌
* ```sortBy```
* ```randomSplit```
* 

## 액션
  * ```reduce```
  * ```count```
  * ```countApporx```
  * ```countApporxDistinct```
    * ```streamlib``` 관련 논문 기반 두 구현체가 있음
    * 첫 구현체에는 상대 정확도를 파라미터로 사용
    * 다른 구현체는 동작 세부적으로 제어 가능
  * ```countByValue```
    * 전체 로우나 고유 아이템 수 적은 경우 사용
  * ```countByValueApprox```
  * ```first```
  * ```max```
  * ```min```
  * ```take```

## 파일 저장하기
* 텍스트 파일
  * ```saveAsTextFile``` 사용
  * 압축 코덱 사용 가능
    * 하둡에서 임포트
* 시퀀스 파일
  * 바이너리 키-값으로 구성된 플랫 파일
  * 맵리듀스 입출력 포맷으로 널리 사용
  * ```saveAsObjetFile``` 사용
* 하둡 파일
  * 클래스, 출력 포맷, 압축 방식 지정 가능
    * 하둡 에코시스템이나 기존 맵리듀스 깊에 다루는 경우 아니면 관련 없음

## 캐싱
* 메모리에 있는 데이터 대상으로 캐시하거나 저장

## 체크포인팅
* RDD를 디스크에 저장

## RDD를 시스템 명령으로 전송하기
* ```pipe``` 메소드
* RDD 외부 프로세스로 전달
  * 파티션마다 한 번씩 처리해 결과 RDD 생성
* **mapPartitions**
  * 파티션 단위로 ```map``` 연산
  * ```mapPartitionWithIndex```는 ```mapPartition```과 유사하나 인덱스와 파티션 모든 아이템 순회하는 함수 인수로 지정해야 함
    * 파티션 인덱스는 RDD 파티션 번호 의미
* **foreachPartition**
  *  ```mapPartition```과 달리 결과 반환 안 함
  * 개별 파티션에 특정 작업 수행 시 유용
* **gloom**
  * 모든 파티션을 배열로 변환
  * 파티션 수 많을 경우 문제 야기할 수 있음